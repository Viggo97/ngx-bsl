<button
    type="button"
    class="button-secondary"
    role="combobox"
    #selectButton
    cdkOverlayOrigin
    [attr.aria-expanded]="open()"
    [attr.aria-controls]="'list-box-' + id()"
    [attr.aria-label]="ariaLabel()"
    [attr.aria-labelledby]="ariaLabelledBy()"
    [attr.aria-activedescendant]="ariaActiveDescendant()"
    (click)="onClick()"
    (keydown.enter)="onKeydown($any($event))"
    (keydown.space)="onKeydown($any($event))"
    (keydown.arrowUp)="onKeydown($any($event))"
    (keydown.arrowDown)="onKeydown($any($event))"
    (keydown.escape)="hideListBox()">
    @if (iconMode()) {
        <ng-content select="[data-custom-icon]"></ng-content>
    } @else {
        <span>{{ value ? (value | listBoxOptionValueConverter : bindLabel()) : placeholder() }}</span>

        @if (customIcon()) {
            <ng-content select="[data-custom-icon]"></ng-content>
        } @else {
            <ngx-bsl-icon-chevron-down></ngx-bsl-icon-chevron-down>
        }
    }
</button>
<ng-template
    cdkConnectedOverlay
    [cdkConnectedOverlayOrigin]="selectButton"
    [cdkConnectedOverlayOpen]="open()"
    [cdkConnectedOverlayWidth]="dropdownWidth() || selectButton.offsetWidth"
    (overlayOutsideClick)="hideListBox()">
    <ngx-bsl-list-box
        [initialValue]="value"
        [initialFocusedOptionIndex]="initialFocusedOptionIndex()"
        [comparisonField]="comparisonField()"
        [id]="'list-box-' + id()"
        [ariaLabel]="ariaLabel()"
        [ariaLabelledby]="ariaLabelledBy()"
        [exposeAriaActiveDescendant]="true"
        (selectOption)="onSelectOption($event)">
        @for (option of options(); track option) {
            <ngx-bsl-list-box-option
                [id]="'list-box-option-' + id()"
                [value]="option">
                <ng-container>{{ option | listBoxOptionValueConverter : bindLabel() }}</ng-container>
            </ngx-bsl-list-box-option>
        }
    </ngx-bsl-list-box>
</ng-template>
